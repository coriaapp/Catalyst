"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.randomBytes = void 0;
var crypto_1 = require("./crypto");
var randombytesfn = function (x, y) {
    throw new Error('No PRNG randombytes fn found');
};
function randomBytes(len) {
    var b = new Uint8Array(len);
    randombytesfn(b, len);
    return b;
}
exports.randomBytes = randomBytes;
(function () {
    // Initialize PRNG if environment provides CSPRNG.
    // If not, methods calling randombytes will throw.
    var QUOTA = 65536;
    randombytesfn = function (x, n) {
        var i;
        var v = new Uint8Array(n);
        for (i = 0; i < n; i += QUOTA) {
            crypto_1.crypto === null || crypto_1.crypto === void 0 ? void 0 : crypto_1.crypto.getRandomValues(v.subarray(i, i + Math.min(n - i, QUOTA)));
        }
        for (i = 0; i < n; i++)
            x[i] = v[i];
        cleanup(v);
    };
})();
function cleanup(arr) {
    for (var i = 0; i < arr.length; i++)
        arr[i] = 0;
}
//# sourceMappingURL=randombytes.js.map